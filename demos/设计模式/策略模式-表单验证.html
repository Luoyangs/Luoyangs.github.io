<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>

<body>
  <form id="registerForm" action="http://www.baidu.com" method="post">
    <div class="form-item">
      <label for="name">Name:
        <input type="text" name="name" id="name">
      </label>
    </div>
    <div class="form-item">
      <label for="pass">Pass:
        <input type="password" name="pass" id="pass">
      </label>
    </div>
    <div class="form-item">
      <label for="email">Email:
        <input type="text" name="email" id="email">
      </label>
    </div>
    <div class="form-item">
      <button>提交</button>
    </div>
  </form>
</body>
<script>
  var strategies = {
    isNonEmpty: function(value, errorMsg) {
      if (value == '') return errorMsg;
    },
    minLength: function(value, length, errorMsg) {
      if (value.length < length) return errorMsg;
    },
    isEmail: function(value, errorMsg) {
      if (!/(^1[3|5|8][0-9]{9}$)/.test(value)) return errorMsg;
    }
  };

  var Validator = function() {
    this.cache = [];
  }
  Validator.prototype.add = function(ele, rules) {
    var self = this;
    for (var i = 0, rule; rule = rules[i++];) {
      (function(rule) {
        var arrs = rule.strategy.split(':');
        var errorMsg = rule.errorMsg;
        self.cache.push(function() {
          var strategy = arrs.shift();
          arrs.unshift(ele.value);
          arrs.unshift(errorMsg);
          return strategies[strategy].apply(ele, arrs);
        });
      })(rule);
    }
  }
  Validator.prototype.start = function() {
    for (var i = 0, fun; fun = this.cache[i++];) {
      var errorMsg = fun();
      if (errorMsg) return errorMsg;
    }
  }

  var form = document.getElementById('registerForm');
  form.onsubmit = function() {
    var validator = new Validator();
    validator.add(form.name, [{
      strategy: 'isNonEmpty',
      errorMsg: '用户名不得为空'
    }, {
      strategy: 'minLength:6',
      errorMsg: '用户名不能小于6'
    }]);
    validator.add(form.pass, [{
      strategy: 'isNonEmpty',
      errorMsg: '密码不得为空'
    }, {
      strategy: 'minLength:10',
      errorMsg: '密码不能小于10'
    }]);
    validator.add(form.email, [{
      strategy: 'isNonEmpty',
      errorMsg: '邮箱不得为空'
    }, {
      strategy: 'isEmail',
      errorMsg: '邮箱格式不正确'
    }]);
    var errorMsg = validator.start();
    console.log('za', errorMsg)
    if (errorMsg) {
      alert(errorMsg);
      return false;
    }
  }
</script>

</html>